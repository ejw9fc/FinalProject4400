<Window x:Class="FinalProject4400.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:FinalProject4400"
        xmlns:conv="clr-namespace:FinalProject4400.Converters"
        xmlns:models="clr-namespace:FinalProject4400.Models"
        mc:Ignorable="d"
        Title="Weather Dashboard" Height="450" Width="800"
        Background="{DynamicResource WindowGradient}"
        FontFamily="{StaticResource AppFont}"
        FontSize="12">

    <Window.Resources>
        <!-- Register the UNIX‐to‐Date converter -->
        <conv:UnixToDateConverter x:Key="UnixToDateConverter"/>
    </Window.Resources>


    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- Row 0: Search + Favorites -->
            <RowDefinition Height="Auto"/>
            <!-- Row 1: Now -->
            <RowDefinition Height="*"/>
            <!-- Row 2: Forecast -->
        </Grid.RowDefinitions>

        <!-- Row 0: Search on left, Favorites on right -->
        <Grid Grid.Row="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="3*"/>
                <ColumnDefinition Width="2*"/>
            </Grid.ColumnDefinitions>

            <!-- 1A) Search panel -->
            <StackPanel Orientation="Horizontal" Grid.Column="0" VerticalAlignment="Center" Margin="0,0,0,10">
                <Grid Width="250">
                    <TextBox x:Name="LocationTextBox" VerticalContentAlignment="Center" Padding="4"/>
                    <TextBlock Text="e.g. City,ST,US" IsHitTestVisible="False" Foreground="LightGray" Margin="8,0,0,0" VerticalAlignment="Center">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Setter Property="Visibility" Value="Collapsed"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding Text, ElementName=LocationTextBox}" Value="">
                                        <Setter Property="Visibility" Value="Visible"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                </Grid>
                <Button Content="Search"
                    Margin="8,0,0,0"
                    Padding="8,4"
                    Width="40"
                    Click="SearchButton_Click"/>
            </StackPanel>

            <!-- 1B) Favorites panel -->
            <GroupBox Header="Favorites" Grid.Column="1" Foreground="{StaticResource SecondaryColor}" FontWeight="Bold" Margin="16,0,0,0">
                <StackPanel>
                    <ListBox x:Name="FavoritesList"
                        Height="80"
                        SelectionChanged="FavoritesList_SelectionChanged"/>
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,8,0,0">
                        <Button Content="Add"    Width="60" Margin="0,0,4,0" Click="AddFavorite_Click"/>
                        <Button Content="Remove" Width="60" Margin="0,0,4,0"                Click="RemoveFavorite_Click"/>
                    </StackPanel>
                    <TextBlock x:Name="FavErrorText" Foreground="Red" FontSize="10" Margin="0,4,0,0"/>
                </StackPanel>
            </GroupBox>
        </Grid>


        <StackPanel Orientation="Horizontal" Grid.Row="1" Margin="0,0,0,10" VerticalAlignment="Center">
            <TextBlock Text="Now:" Style="{StaticResource HeaderText}" FontWeight="Bold" VerticalAlignment="Center"/>

            <!-- Temperature -->
            <TextBlock x:Name="CurrentTempText"
                FontSize="24"
                Margin="10,0,0,0"
                VerticalAlignment="Center"/>


            <!-- Icon — small margin so it doesn’t overlap -->
            <Image x:Name="CurrentIcon"
                Width="32" Height="32"
                Margin="8,0,0,0"
                VerticalAlignment="Center"/>



            <!-- Condition -->
            <TextBlock x:Name="CurrentCondText"
                FontSize="16"
                Margin="8,0,0,0"
                VerticalAlignment="Center"/>
        </StackPanel>

        <!-- 3) 7-day forecast -->
        <ItemsControl x:Name="ForecastItemsControl" Grid.Row="2">
            <ItemsControl.ItemsPanel>
                <ItemsPanelTemplate>
                    <UniformGrid Columns="7"/>
                </ItemsPanelTemplate>
            </ItemsControl.ItemsPanel>
            <ItemsControl.ItemTemplate>
                <DataTemplate DataType="{x:Type models:ForecastDay}">
                    <Border Padding="8" Margin="5" BorderBrush="LightGray" BorderThickness="1" CornerRadius="12" Background="#FFFFFF">
                        <StackPanel HorizontalAlignment="Center">
                            <!-- Date -->
                            <TextBlock Text="{Binding Dt, Converter={StaticResource UnixToDateConverter}, StringFormat='{}{0:MMM dd}'}"
                               FontWeight="Bold" Style="{StaticResource HeaderText}" FontSize="14"/>
                            <!-- Icon -->
                            <Image Width="50" Height="50" Margin="0,4" Source="{Binding IconImage}"/>
                            <!-- Temperature -->
                            <TextBlock Text="{Binding Temp.Day, StringFormat='{}{0:F0}°F'}"/>
                            <!-- Weather Description -->
                            <TextBlock Text="{Binding Weather[0].Main}"/>
                        </StackPanel>
                    </Border>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>
    </Grid>
</Window>
